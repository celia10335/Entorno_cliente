<!DOCTYPE html>
<html lang="es-es">
  <head>
    <meta charset="UTF-8" />
    <title>Cifrado César</title>
  </head>
  <body>
    <script>
      // declaro variables que necesitaré más adelante
      let clave;
      let cambiarPor;
      let nuevoCode;
      let prueba;

      // bucle para controlar que la clave introducida es un número entre 1 y 100
      do {
        clave = Number(prompt("Introduce un valor numérico para la clave"));
      } while (isNaN(clave) || clave < 0 || clave > 100);



      if (clave == 0) { // si se hace clic en "cancelar", el valor es 0 y se sale del programa
        alert("Se ha cancelado el programa");

      } else {
       
        let texto = prompt("Introduce texto a cifrar");

        if (texto == "") {  // controlar que el texto es válido, no una cadena vacía
          alert("No es posible cifrar una cadena vacía");

        } else if (texto == null) { // si se hace clic en "cancelar", se sale del programa
          alert("Se ha cancelado el programa");
         
        } else {    // si el texto introducido es válido:
          texto = texto.toUpperCase();

          for (let i = 0; i < texto.length; i++) {
            if (texto.charAt(i) != " ") {

              if (texto.charCodeAt(i) == 90) {
                // en caso de que sea Z, se pasa al código justo antes de la A
                nuevoCode = 64 + clave;

              } else {
                nuevoCode = Number(texto.charCodeAt(i)) + clave;
              }
              cambiarPor = String.fromCharCode(nuevoCode); // obtener carácter desplazado
              texto = texto.replace(texto.charAt(i), cambiarPor); // reemplazar carácter
            }
          }
          document.write("El texto cifrado es: " + texto);
        }
        
      }
    </script>

  </body>
</html>

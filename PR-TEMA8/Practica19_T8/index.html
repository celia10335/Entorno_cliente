<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./estilo.css" />
    <title>Datos JSON</title>
  </head>
  <body>
    <form action="#"></form>
    <h3></h3>
    <div class="botones">
      <button id="atras">&lt;</button>
      <button id="adelante">&gt;</button>
    </div>
    <script>
      // Capturo los elementos que voy a necesitar: formulario, párrafo para lanzar mensaje de error y botones de adelante y atrás.
      let formu = document.querySelector('form');
      let mensajeError = document.querySelector('h3');
      let atras = document.getElementById('atras');
      let adelante = document.getElementById('adelante');

      let i = 1;

      adelante.addEventListener('click', () => {
        i = i + 1;
      });

      console.log('valor de ' + i);

      // Con el método fetch extraigo la información del archivo que está en este mismo directorio.
      fetch('http://jsonplaceholder.typicode.com/posts/' + i)
        // Utilizo una promesa para operar con los datos. Si la conexión va bien, transforma el JSON en cadena de texto, después en objeto y después en array.
        .then((respuesta) => {
          if (respuesta.ok) {
            //Nos aseguramos que no haya errores
            return respuesta.json(); //Devuelve un objeto en formato JSON
          } else {
            throw new Error('Los datos no llegaron bien');
          }
        })
        .then((miJSON) => {
          //Recoge nuestra respuesta JSON
          console.log(miJSON); //Sacamos el objeto por consola
          //Volcamos los datos
          formu.innerHTML =
            '<div><label for="userId">UserID</label><input type="text" name="userId" value="' +
            miJSON.userId +
            '" /></div><div><label for="id">ID</label><input type="text" name="id" value="' +
            miJSON.id +
            '" /></div><div><label for="title">Título</label><input type="text" name="title" value="' +
            miJSON.title +
            '" /></div><div><label for="body">Cuerpo</label><textarea type="text" name="body">' +
            miJSON.body +
            '</textarea></div>';
        }) //Lo podemos hacer así porque miJSON es un objeto con sus propiedades
        .catch((error) => {
          parrafo.textContent = 'Error: ' + error;
        });
    </script>
  </body>
</html>
